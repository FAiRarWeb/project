<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Combined AR App</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.0.0/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    <style>
      .a-enter-vr {
        display: none !important;
      }

      #toggle-button {
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        padding: 20px 50px;
        font-size: 16px;
        background-color: white;
        color: black;
        border: 5px solid transparent;
        border-radius: 27px;
        box-shadow: 0px 10px 13px -7px #000, 5px 5px 15px 5px rgba(0, 0, 0, 0);
      }

      .ar-link {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #4caf50;
        color: white;
        padding: 15px 30px;
        border-radius: 25px;
        text-decoration: none;
        font-family: Arial, sans-serif;
        font-size: 18px;
        display: none;
        z-index: 1000;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .target-text {
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .tv-frame {
        width: 1.1;
        height: 0.6;
        background-color: #333;
        border-radius: 0.1;
      }

      .tv-stand {
        width: 0.2;
        height: 0.1;
        background-color: #333;
      }

      body {
        margin: 0;
        overflow: hidden;
      }
    </style>
  </head>

  <body>
    <button id="toggle-button" onclick="toggleInfo()">Info</button>
    <a href="#" class="ar-link" id="websiteLink">Visit Website</a>

    <a-scene
      mindar-image="imageTargetSrc: https://driyanyy.github.io/project/targets.mind; uiScanning: no"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
      renderer="precision: high; antialias: true;"
    >
      <a-assets>
        <video
          id="ar-video"
          src="https://driyanyy.github.io/project/WhatsApp%20Video%202025-05-20%20at%2010.08.10_53f8c34b.mp4"
          autoplay
          loop
          muted
          playsinline
          crossorigin="anonymous"
        ></video>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <!-- Target 0: With Video -->
      <a-entity mindar-image-target="targetIndex: 0" id="target-0">
        <a-plane color="#333" width="1.1" height="0.6" position="0 0 -0.01"></a-plane>
        <a-video
          id="video-plane"
          src="#ar-video"
          position="0 0 0"
          width="1"
          height="0.45"
          visible="true"
        ></a-video>
        <a-text
          class="target-text"
          value="Link A"
          color="white"
          position="0 0.6 0"
          scale="0.5 0.5 0.5"
        ></a-text>
      </a-entity>

      <!-- Target 1: Only Text -->
      <a-entity mindar-image-target="targetIndex: 1" id="target-1">
        <a-text
          class="target-text"
          value="Link B"
          color="yellow"
          position="0 0.5 0"
          scale="0.5 0.5 0.5"
        ></a-text>
      </a-entity>
    </a-scene>

    <script>
      let isInfoShown = false;
      let currentTarget = null;

      const websiteLink = document.getElementById("websiteLink");
      const video = document.getElementById("ar-video");
      const videoPlane = document.getElementById("video-plane");
      const targetTexts = document.querySelectorAll(".target-text");

      function hideAllTexts() {
        targetTexts.forEach(text => text.setAttribute("opacity", "0"));
      }

      function showCurrentText() {
        if (currentTarget === "target-0") {
          document.querySelector("#target-0 .target-text").setAttribute("opacity", "1");
        } else if (currentTarget === "target-1") {
          document.querySelector("#target-1 .target-text").setAttribute("opacity", "1");
        }
      }

      function toggleInfo() {
        if (!currentTarget) return;

        isInfoShown = !isInfoShown;

        if (isInfoShown) {
          video.pause();
          videoPlane.setAttribute("visible", false);
          showLinkForTarget(currentTarget);
          showCurrentText();
        } else {
          hideLink();
          hideAllTexts();
          videoPlane.setAttribute("visible", true);
          video.play();
        }
      }

      function showLinkForTarget(targetId) {
        if (targetId === "target-0") {
          websiteLink.href = "https://www.youtube.com/";
          websiteLink.textContent = "Visit YouTube";
        } else if (targetId === "target-1") {
          websiteLink.href = "https://www.wikipedia.org/";
          websiteLink.textContent = "Visit Wikipedia";
        }
        websiteLink.style.display = "block";
      }

      function hideLink() {
        websiteLink.style.display = "none";
      }

      document.querySelector("#target-0").addEventListener("targetFound", () => {
        currentTarget = "target-0";
        if (!isInfoShown) {
          video.play();
          videoPlane.setAttribute("visible", true);
        }
      });

      document.querySelector("#target-0").addEventListener("targetLost", () => {
        currentTarget = null;
        video.pause();
        videoPlane.setAttribute("visible", false);
        hideLink();
        hideAllTexts();
        isInfoShown = false;
      });

      document.querySelector("#target-1").addEventListener("targetFound", () => {
        currentTarget = "target-1";
        if (isInfoShown) {
          showCurrentText();
        }
      });

      document.querySelector("#target-1").addEventListener("targetLost", () => {
        currentTarget = null;
        hideLink();
        hideAllTexts();
        isInfoShown = false;
      });
    </script>
  </body>
</html>
